<!DOCTYPE Chinese>
<html lang="ja">

<head>
  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>å……å®Ÿåˆç´šå˜èªã‚«ãƒ¼ãƒ‰</title>
  <style>
    .header {
      position: fixed;
      top: 0px;
      left: 0px;
      z-index: 10;
      background-color: #f4c4ee;
      width: 100%;


    }

    .divTangoCardDisplay {
      display: block;
    }

    .divTangoCardNoDisplay {
      display: none;
    }

    #flashcard {
      margin-top: 120px;
      width: 340px;
      height: 200px;
      border: 1px solid #000;
      text-align: center;
      /* line-height: 200px; */
      display: flex; 
      justify-content: center;
      align-items: center;
      font-size: 20px;
    }

    /* ãƒœã‚¿ãƒ³ã®ã‚¹ã‚¿ã‚¤ãƒ«ã‚’å¤‰æ›´ã—ã¦ã‚µã‚¤ã‚ºã‚’å¤§ããã™ã‚‹ */
    button {
      font-size: 20px;
      /* ãƒ•ã‚©ãƒ³ãƒˆã‚µã‚¤ã‚ºã‚’å¤§ããã™ã‚‹ */
      padding: 10px 15px;
      /* ãƒ‘ãƒ‡ã‚£ãƒ³ã‚°ã‚’å¢—ã‚„ã—ã¦ãƒœã‚¿ãƒ³ã®ã‚µã‚¤ã‚ºã‚’èª¿æ•´ã™ã‚‹ */
      margin: 10px;
      /* ãƒãƒ¼ã‚¸ãƒ³ã‚’è¿½åŠ ã—ã¦ãƒœã‚¿ãƒ³ã‚’é…ç½®ã—ã‚„ã™ãã™ã‚‹ */
    }

    body {
      background-color: #f4c4ee;
    }

    h1 {
      color: blue;
    }



    .chkboxL {
      display: inline-block;
      margin-top: 19px;
      margin-left: 4px;
    }

    .showCardBlock {
      display: block;
    }

    .showCardNone {
      display: none;
    }

    .formDisplayNone {
      display: none;
    }

    .formDisplayBlock {
      display: block;
    }

    #inputHanyu {
      display: inline-block;
      width: 200px;
      height: 50px;
    }

    .result {
      font-size: 20px;
      margin-top: 20px;
      display: none;
    }

    .resultBlock {
      display: block;
    }

    .rusultNone {
      display: none;
    }

    .header2 {
      
      display: flex;
    }
    .logo {
      display: flex;
    }
    .logo p {
      margin: 0px;
    }
    #timer {
      display: inline-block;
      background: pink;
      width: 70px;
      height: 40px;
      font-size: 16px;
    }
    .logo #timer {
      margin-left: 5px;
    }
    .linkurl {
      margin-left: auto;
    }

    #flash {
      display: inline-block;
      width: 70px;
      height: 40px;
      cursor: pointer;
      background-color: skyblue;
      text-decoration: none;
      text-align: center;
      line-height: 50px;
      border-radius: 6px
    }

    #ikeda {
      display: inline-block;
      width: 70px;
      height: 40px;
      cursor: pointer;
      background-color: pink;
      text-decoration: none;
      text-align: center;
      line-height: 50px;
      border-radius: 6px
    }

    #btnKensaku {
      display: none;
    }

    #resultKensaku {
      position: relative;
      top: 100px;
      left: 0px;
      z-index: 1;
      width: auto;

      /* padding-top: 12px; */
      background-color: white;

    }

    .resultKensakuDisplay {
      display: block;
    }

    .resultKensakuNoDisplay {
      display: none;

    }

    #resultKensakuClear {
      margin: 10px 10px;
      width: 100px;
      height: 50px;
      cursor: pointer;
      background-color: skyblue;

      text-align: center;
      line-height: 50px;
      border-radius: 6px
    }

    .imgDivDisplay {
      display: block;

    }

    .imgDivNoDisplay {
      display: none;
    }
    .classImageSize {
      width: 100px;
      height: 100px;
    }

    #inputHanyu {
      font-size: 18px;
    }

    #etcInfo {
      display: flex;
    }

    #Internet {
      margin-top: 20px;
      margin-left: 20px;
      background-color: skyblue;
      width: 90px;
      height: 30px;
    }

    #infoInternet {
      text-decoration: none;
    }

    .internetNoDisplay {
      display: none;
    }

    .internetDisplay {
      display: block;
    }

    #header3 {

      display: flex;
    }

    #questionNo {
      margin-left: 30px;
    }
    #kensaku{
      margin-left: 10px;
    }

    .totalGrade {
      padding-left: 30px;

      display: none;
      animation: 03s fadeIn;
    }

    .totalGradeDisplay {
      display: block;
    }

    .totalGradeNoDisplay {
      display: none;
    }

    #totalSeitouritsu {
      font-size: 24px;
    }

    #totalComment {
      font-size: 24px;
      color: red;
    }
    .clkBtn {
      cursor: pointer;
      user-select: none;
      background-color: #fffacd;
    }
    .loading {
      position: fixed;
      top: 100px;
      left: 100px;
      z-index: 99;
      content: '';
      display: block;
      margin: auto;
      width: 300px;
      border: 4px solid #ccc;
      border-right-color: #0AC;
      border-radius: 100px;
      width: 30px;
      height: 30px;
      background-color: white;
      animation: rotation 0.6s linear infinite;
    }

    @keyframes rotation {
      from {
        transform: rotate(0);
      }

      to {
        transform: rotate(360deg);
      }
    }


    @keyframes fadeIn {
      0% {
        opacity: 0;
        transform: translateY(-10px);

      }

      100% {
        opacity: 1;
        transform: none;
      }

    }
  </style>
  <!--  ã‚¹ãƒ—ãƒ¬ãƒƒãƒ‰ã‚·ãƒ¼ãƒˆã®æƒ…å ±ã‚’èª­ã¿è¾¼ã‚€ãŸã‚ã«å¿…è¦ -->

  <link href="https://cdnjs.cloudflare.com/ajax/libs/lightbox2/2.7.1/css/lightbox.css" rel="stylesheet">
  <script src="https://code.jquery.com/jquery-1.12.4.min.js" type="text/javascript"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/lightbox2/2.7.1/js/lightbox.min.js"></script>

</head>

<body>
  <div id="kurukuru" class="loading"></div>
  <div class="header">
    <div class="header2">
      <div class="logo">
        <h3>å˜èªã‚«ãƒ¼ãƒ‰</h3>
        <!-- <p>å˜èªã‚«ãƒ¼ãƒ‰ã€€<button id="timer">è¨ˆæ¸¬</button></p> -->

      </div>
      <div>
        <label class="chkboxL"><input id="chkbox" type="checkbox">ãƒ”ãƒ³ã‚¤ãƒ³å…¥åŠ›</label>

      </div>
      <div class="linkurl">
        <a id="flash"
        href="https://script.google.com/macros/s/AKfycbwCL3tny-JoGZehVtlIoO5bAdv5MVrEG88dCRBJmFTwp5cPgYwnhXRgssoVwQmY6f0/exec"
        target="_blank">æœ¬æ–‡</a>

        <!-- <a id="ikeda" href="index6.Chinese" target="_blank">ä½¿ç”¨æ‰‹å¼•æ›¸</a> -->
        <a id="ikeda" href="https://drive.google.com/file/d/1xExBsjozNSCnDzwf80Gl3rN_VejIsiju/view?usp=sharing" target="_blank">Help</a>

      </div>
    </div>
    <div id="header3">
      <!-- ã‚·ãƒ¼ãƒˆã‚»ãƒ¬ã‚¯ãƒˆãƒœãƒƒã‚¯ã‚¹ -->
      <div class="sheetSelect">

        <label for="sheet-select">é¸æŠï¼š</label><select id="sheet-select" name="sheetSelect"></select>
      </div>
      <div id="questionNo"></div>
      <div id="kensaku">
        <form>
          <input type="text" id="myInput" placeholder="æ¤œç´¢ã—ãŸã„è¨€è‘‰ã‚’å…¥åŠ›ã—ã¦ãã ã•ã„ã€‚">
          <button id="btnKensaku">æ¤œç´¢</button>
        </form>
      </div>
    </div>
  </div>
  <!-- hajime -->
  <div id="divTangoCard" class="divTangoCardDisplay">


    <div id="flashcard">Click to see definition/ğŸ‘‰æŒ‰ã€Œä¸‹ä¸€ä¸ªã€ï¼ˆæ¬¡ã¸ï¼‰ğŸ¼çœ‹å•è¯å¡</div>
    <div id="etcInfo">
      <div id="imgDiv" class="imgDivNoDisplay">
        <a id="aGazou" target="_blank"><img id="imgGazou" width="100" height="100"></a>

      </div>
      <div id="Internet" class="internetNodisplay">
        <a id="infoInternet">å‚è€ƒã‚µã‚¤ãƒˆ</a>

      </div>
    </div>
    <div class="showCard showCardBlock">
      <button onclick="showPreviousCard()">ä¸Šä¸€ä¸ª</button>
      <button onclick="showAnswer()">ä¸‹ä¸€ä¸ª</button>

    </div>
    <form class="formDisplay formDisplayNone">
      <input id="inputHanyu" type="text">
      <button id="chkInput">ãƒã‚§ãƒƒã‚¯</button>
      <p id="comment"></p>
    </form>
    <div id="resultID" class="result resultNone">æ­£è§£: 0 å› ä¸æ­£è§£: 0 å›</div>
    <div class="totalGrade totalGradeNoDisplay">
      <p id="totalSeitouritsu"></p>
      <p id="totalComment"></p>

    </div>
  </div>
  <!-- owari -->
  <div id="resultKensaku" class="resultKensakuNoDisplay">
    <!-- <div id="resultKensakuContent"> -->


   
  </div>


  <script>
    // ã‚¹ãƒ—ãƒ¬ãƒƒãƒ‰ã‚·ãƒ¼ãƒˆã€€å˜èªã‚«ãƒ¼ãƒ‰3ã€€gas webã‚¢ãƒ—ãƒªã€€URL  å˜èªã‚«ãƒ¼ãƒ‰3
    const END_POINT = "https://script.google.com/macros/s/AKfycbyxQF6ra_N6kJ1bGfaQV9j87f53-ESW_ovbUjoPuiONzAHKRZ2ApIhiBG7RhJub4FgN/exec";

    // ios ä¸­å›½èªéŸ³å£°ä¸å…·åˆã®è¨‚æ­£
    // 2024/12-09
    let voices = [];
    // åˆæœŸéŸ³å£°ãƒªã‚¹ãƒˆã®å–å¾—
    voices = speechSynthesis.getVoices();
    // éŸ³å£°ãƒªã‚¹ãƒˆãŒå–å¾—ã§ããªã„å ´åˆã¯ã€éŸ³å£°ãƒªã‚¹ãƒˆãŒå–å¾—ã§ãã‚‹ã‚ˆã†ã«ãªã‚‹ã¾ã§å¾…æ©Ÿ
    // 2024/12-09
    // ã‚¹ãƒ—ãƒ¬ãƒƒãƒ‰ã‚·ãƒ¼ãƒˆã€€å˜èªã‚«ãƒ¼ãƒ‰ã‚’èª­ã¿è¾¼ã‚“ã§é…åˆ—ã€€flashcardDataã«ã‚»ãƒƒãƒˆ
    let flashcardDatas;  // å…¨ã‚·ãƒ¼ãƒˆã®flashdata
    let flashcardData;   // ãƒ•ãƒ©ãƒƒã‚·ãƒ¥ã‚«ãƒ¼ãƒ‰æ–°å½¢å¼
    let flashcardData2;  // ãƒ•ãƒ©ãƒƒã‚·ãƒ¥ã‚«ãƒ¼ãƒ‰æ—§å½¢å¼
    let sheetIndex = 0;
    let currentIndex = -1;
    let correctCount = 0;
    let incorrectCount = 0;
    let isPinyin = false;
    let isKanjiCheck = false;
    let textChinese;  // ã€€ãƒ”ãƒ³ã‚¤ãƒ³å‰Šé™¤å¾Œã®ä¸­å›½èªã‚’è¨˜æ†¶
    let tdOLD;
    let tdOLDColor;  
    let kurukuru = document.getElementById('kurukuru');
    let startTime;
    let endTime;
    const flashcard = document.getElementById('flashcard');
    // const button = document.querySelector('button');
    const sheetSelector = document.getElementById("sheet-select");
    let termSave;  //  ãƒ•ãƒ©ãƒƒã‚·ãƒ¥ã‚«ãƒ¼ãƒ‰ã‚’ã‚¯ãƒªãƒƒã‚¯ã—ãŸã¨ãã«è¡¨ç¤ºå†…å®¹ãŒä¸­å›½èªã‹ã©ã†ã‹ã‚’åˆ¤å®šã™ã‚‹ãŸã‚



    const synth = window.speechSynthesis;
    // éåŒæœŸå‡¦ç†ã€€ã™ãƒ–ãƒ¬ãƒƒãƒ‰ã‚·ãƒ¼ãƒˆã®å˜èªã‚«ãƒ¼ãƒ‰èª­ã¿è¾¼ã¿é–¢æ•°
    // èª­ã¿è¾¼ã¿ãŒæˆåŠŸã™ã‚Œã°flashcardDataã«ãƒ‡ãƒ¼ã‚¿ã‚’æ ¼ç´ã™ã‚‹ã€‚
    function flashcardYomikomi() {
      $.ajax({
        type: "GET",
        url: END_POINT,
        // data: { sheetNo: SHEET_NO }

      }).done((result) => {        // æˆåŠŸã—ãŸæ™‚ã®å‡¦ç†
        console.log("get done:" + result);
        setSheetNames(JSON.parse(result)[0]);

        flashcardDatas = JSON.parse(result);
        flashcardData = JSON.parse(result)[1];
        flashcardData2 = flashcardGenerate(flashcardData);
        kurukuru.remove();

      }).fail((error) => {  // å¤±æ•—ã—ãŸæ™‚ã®å‡¦ç†
        alert('Error:' + JSON.stringify(error));

      }).always((data) => {// å¸¸ã«ã‚„ã‚‹å‡¦ç†
        // do something
        // enableControlElements();
      });
    }
    flashcardYomikomi();  // ã‚¹ãƒ—ãƒ¬ãƒƒãƒ‰ã‚·ãƒ¼ãƒˆèª­ã¿è¾¼ã¿
    //
   
    
    const resultDiv = document.getElementById('resultID');
    // 2024-03-12
    const chkbox = document.getElementById('chkbox');
    // const pinyinInput = document.getElementById('pinyinInput');
    const formDisplay = document.querySelector('.formDisplay');
    const inputHanyu = document.getElementById('inputHanyu');
    const chkInput = document.getElementById('chkInput');
    const showCard = document.querySelector('.showCard');
    let comment = document.getElementById('comment');
    const totalGrade = document.querySelector('.totalGrade');
    const imgDiv = document.getElementById('imgDiv');
    const aGazou = document.getElementById('aGazou');
    const imgGazou = document.getElementById('imgGazou');
    const questionNo = document.getElementById('questionNo');
    let Internet = document.getElementById('Internet');
    const resultKensaku = document.getElementById('resultKensaku');
    let resultKensakuContent = document.getElementById('resultKensakuContent');
    let resultKensakuClear = document.getElementById('resultKensakuClear');
    const myInput = document.getElementById('myInput');
    const divTangoCard = document.getElementById('divTangoCard');
    // ãƒã‚§ãƒƒã‚¯ãƒœãƒƒã‚¯ã‚¹ãŒå¤‰æ›´ã•ã‚ŒãŸã¨ã
    chkbox.addEventListener('change', () => {
      if (chkbox.checked) {
        isPinyin = true;
        inputHanyu.value = '';
        isKanjiCheck = false;
        comment.textContent = '';
        
        startTime = Date.now(); // é–‹å§‹æ™‚é–“
      
   
      } else {
        isPinyin = false;
        fncFormDisplayNone();

        comment.textContent = '';
      }
      chkboxChenged();

    });
    //
    function fncFormDisplayNone() {
      formDisplay.classList.add('formDisplayNone');
      formDisplay.classList.remove('formDisplayBlock');
      showCard.classList.add('showCardBlock');
      showCard.classList.remove('showCardNone');
    }
    chkInput.addEventListener('click', (e) => {
      e.preventDefault();
      if (isKanjiCheck) {
        isKanjiCheck = false;
        chkInput.textContent = 'ãƒã‚§ãƒƒã‚¯';
        fncFormDisplayNone();
        showAnswer();
        inputHanyu.value = '';
        inputHanyu.focus();
        comment.textContent = '';
      } else {


        showAnswer();
        chkInput.textContent = 'ä¸‹ä¸€ä¸ª';
        isKanjiCheck = true;
        // showCard.classList.add('showCardBlock');
        // showCard.classList.remove('showCardNone');
        console.log(inputHanyu.value);
        console.log(`flash= ${flashcardData2[currentIndex]}`);
        console.log(`textChinese=${textChinese}`);
        if (textChinese === inputHanyu.value) {
          comment.textContent = 'å¥½ï¼èµğŸ‘ğŸ¼è¯´';
          speakText2(comment.textContent);
          console.log('seikai')
          correctCount++;
        } else {
          comment.textContent = 'é”™Ã—ã€€å†åŠ æ²¹ï¼ï¼';
          speakText2(comment.textContent);
          console.log('fuseikai');
          incorrectCount++;
        }


        displayResult();
      }
    });
    // 2024/03/12
    // ã‚·ãƒ¼ãƒˆé¸æŠã•ã‚ŒãŸã¨ãã®å‡¦ç†
    let select = document.querySelector('[name="sheetSelect"]');

    select.onchange = event => {
      var selIndex = select.selectedIndex;
      sheetIndex = selIndex;
      console.log(select.selectedIndex);

      flashcardData = flashcardDatas[selIndex + 1];

      flashcardData2 = flashcardGenerate(flashcardData);
      currentIndex = -1;
      correctCount = 0;
      incorrectCount = 0;
      questionNo.textContent = '';
      fncFormDisplayNone();
      fncImageNoDisplay();

      displayResult();
      flashcard.textContent = 'ğŸ‘‰æŒ‰ã€Œä¸‹ä¸€ä¸ªã€ï¼ˆæ¬¡ã¸ï¼‰ğŸ¼çœ‹å•è¯å¡';
      totalGrade.classList.remove('totalGradeDisplay');
      totalGrade.classList.add('totalGradeNoDisplay');

    }
    // ã‚·ãƒ¼ãƒˆã®ã‚»ãƒ¬ã‚¯ãƒˆãƒœãƒƒã‚¯ã‚¹ã€€ä½œæˆå‡¦ç†
    function setSheetNames(sheetNamesArray) {
      sheetSelector.innerChinese = "";
      document.createElement('option')
      sheetNamesArray.forEach((sheetName, index) => {
        let option = document.createElement('option');
        option.setAttribute('value', index + 1);
        option.innerHTML = sheetName;
        sheetSelector.appendChild(option);
      });
    }
    //  ãƒ•ãƒ©ãƒƒã‚·ãƒ¥ã‚«ãƒ¼ãƒ‰ã®ãƒ•ã‚©ãƒ¼ãƒãƒƒãƒˆã‚’æ—§å½¢å¼ã«å¤‰æ›ã™ã‚‹
    //  ãƒ—ãƒ­ã‚°ãƒ©ãƒ ã®å¤‰æ›´ã‚’å°‘ãªãã™ã‚‹ãŸã‚
    function flashcardGenerate(flashcardData) {
      let j = 0;
      let flashcardData2 = [];
      for (let i = 0; i < flashcardData.length; i++) {
        let gyou = ['jp', flashcardData[i][1], flashcardData[i][4], flashcardData[i][5], flashcardData[i][0]];
        flashcardData2.push(gyou);
        gyou = ['ch', flashcardData[i][2] + '/' + flashcardData[i][3], flashcardData[i][4], flashcardData[i][5], flashcardData[i][0]];
        flashcardData2.push(gyou);

      }
      return flashcardData2;
    }
    // ãƒ”ãƒ³ã‚¤ãƒ³å…¥åŠ›ã®ãƒã‚§ãƒƒã‚¯ãƒœãƒƒã‚¯ã‚¹ãŒå¤‰åŒ–ã—ãŸæ™‚
    function chkboxChenged() {
      currentIndex = -1;
      correctCount = 0;
      incorrectCount = 0;
      questionNo.textContent = '';
      totalGrade.classList.remove('totalGradeDisplay');
      totalGrade.classList.add('totalGradeNoDisplay');
      flashcard.textContent = 'ğŸ‘‰æŒ‰ã€Œä¸‹ä¸€ä¸ªã€ï¼ˆæ¬¡ã¸ï¼‰ğŸ¼çœ‹å•è¯å¡';
      showCard.classList.add('showCardBlock');
      showCard.classList.remove('showCardNone');
      let result = document.querySelector('.result');
      if (isPinyin) {
        result.classList.add('resultBlock');
        result.classList.remove('resultNone');
        displayResult();
      } else {
        result.classList.remove('resultBlock');
        result.classList.add('resultNone');

      }
      fncImageNoDisplay();

    }
    function fncImageNoDisplay() {
      imgDiv.classList.add('imgDivNoDisplay');
      imgDiv.classList.remove('imgDivDisplay');
      Internet.classList.remove('internetDisplay');
      Internet.classList.add('internetNoDisplay');

    }



    // ç­”ãˆã‚’è¡¨ç¤ºã—ã€éŸ³å£°ã‚’å†ç”Ÿã™ã‚‹é–¢æ•°
    function showAnswer() {

      currentIndex++;
      if (currentIndex === flashcardData2.length) {
        if (isPinyin) {
          totalGrade.classList.add('totalGradeDisplay');
          totalGrade.classList.remove('totalGradeNoDisplay');
          let totalSeitouritsu = document.getElementById('totalSeitouritsu');
          let totalComment = document.getElementById('totalComment');
          let mondaisu = flashcardData2.length / 2;
          let ritsu = correctCount * 100 / mondaisu;
          totalSeitouritsu.textContent = `æ­£ç­”æ•°ã¯${correctCount}, æ­£ç­”ç‡ã¯${ritsu.toFixed(1)}ã§ã—ãŸã€‚`;
          if (correctCount === mondaisu) {

            totalComment.textContent = 'æ­å–œæ­å–œ!!ğŸ¼è¯´';

            speakText2('æ­å–œæ­å–œ!!ğŸ¼è¯´');
          } else {
            totalComment.textContent = '';

          }
          //
          if (startTime > 0) {
            endTime = Date.now(); // çµ‚äº†æ™‚é–“
            let syoriTime = endTime - startTime;
            console.log(syoriTime);
            let syoriMinute = Math.floor(syoriTime / 60000);
            if (syoriMinute < 1) {
              syoriMinute = 0;
            }
            let syoriSecond = syoriTime % 60000;
            syoriSecond = syoriSecond / 1000;

            div = document.createElement('div');
            div.textContent = `å‡¦ç†æ™‚é–“ã¯${syoriMinute}åˆ†${syoriSecond.toFixed(1)}ç§’ã§ã—ãŸã€‚`;
            totalGrade.appendChild(div);

          }

          return;



        }
      }
      if (currentIndex === flashcardData2.length) {
        currentIndex = 0;
      }

      const currentData = flashcardData2[currentIndex];
      console.log(`currentdata= ${currentData}`);
      flashcard.textContent = currentData[1];
      fncGazouInternet(currentData);

      let strQuestionNo = `${currentData[4]}/${flashcardData2.length / 2}`;
      questionNo.textContent = strQuestionNo;

      termSave = currentData[0];
      // termãŒChineseã®æ™‚ã«ä¸­å›½ã ã‹ã‚‰ã€€Chineseã®æ™‚ã ã‘speakTextã‚’å‘¼ã³å‡ºã™ã€‚
      if (currentData[0] === 'ch') {

        speakText(currentData[1]);
      }
      //
      if (currentData[0] === 'jp') {
        if (isPinyin) {
          formDisplay.classList.add('formDisplayBlock');
          formDisplay.classList.remove('formDisplayNone');
          showCard.classList.add('showCardNone');
          showCard.classList.remove('showCardBlock');

        }
      }

    }
    function fncGazouInternet(currentData) {
      if (currentData[2] !== '') {
        imgDiv.classList.add('imgDivDisplay');
        imgDiv.classList.remove('imgDivNoDisplay');
        aGazou.setAttribute('href', currentData[2]);
        imgGazou.setAttribute('src', currentData[2]);

      } else {
        imgDiv.classList.remove('imgDivDisplay');
        imgDiv.classList.add('imgDivNoDisplay');

        aGazou.setAttribute('href', '');
        imgGazou.setAttribute('src', '');


      }

      if (currentData[3] !== '') {
        Internet.classList.add('internetDisplay');
        Internet.classList.remove('internetNoDisplay');
        let infoInternet = document.getElementById('infoInternet');

        let gazouURL0 = currentData[3];
        infoInternet.setAttribute('href', gazouURL0);
        // atag.setAttribute('class', 'classGazou');
        infoInternet.setAttribute('target', '_blank');

      } else {
        Internet.classList.remove('internetDisplay');
        Internet.classList.add('internetNoDisplay');

      }
    }
    // å‰ã®ã‚«ãƒ¼ãƒ‰ã‚’è¡¨ç¤ºã™ã‚‹é–¢æ•°
    function showPreviousCard() {
      currentIndex = currentIndex - 1;
      if (currentIndex < 0) {
        currentIndex = 0;
      }
      const currentData = flashcardData2[currentIndex];
      fncGazouInternet(currentData);
      flashcard.textContent = currentData[1];
      let strQuestionNo = `${currentData[4]}/${flashcardData2.length / 2}`;
      questionNo.textContent = strQuestionNo;
      termSave = currentData[0];
      // termãŒChineseã®æ™‚ã«ä¸­å›½ã ã‹ã‚‰ã€€Chineseã®æ™‚ã ã‘speakTextã‚’å‘¼ã³å‡ºã™ã€‚
      if (currentData[0] === 'ch') {
        speakText(currentData[1]);
      }
    }

    // ãƒ†ã‚­ã‚¹ãƒˆã‚’éŸ³å£°ã«å¤‰æ›ã—ã¦å†ç”Ÿã™ã‚‹é–¢æ•°
    function speakText(text) {
      textChinese = text.split('/')[0];
      console.log(`splitå‰= ${text}`);
      console.log(`splitå¾Œ= ${textChinese}`);
      const utterance = new SpeechSynthesisUtterance(textChinese);
      utterance.lang = 'zh-CN'; // ä¸­å›½èªã®è¨€èªã‚³ãƒ¼ãƒ‰
      // ios ä¸­å›½èªéŸ³å£°ä¸å…·åˆã®è¨‚æ­£
      // åˆ©ç”¨å¯èƒ½ãªéŸ³å£°ã‚’ç¢ºèª
      const voices = speechSynthesis.getVoices();
      const chineseVoice = getChineseVoice();

      if (chineseVoice) {
        utterance.voice = chineseVoice;
      } else {
        console.warn('Chinese voice not found, using default voice.');
      }
      // ios ä¸­å›½èªéŸ³å£°ä¸å…·åˆã®è¨‚æ­£
      synth.speak(utterance);
    }
    // ãƒ†ã‚­ã‚¹ãƒˆã‚’éŸ³å£°ã«å¤‰æ›ã—ã¦å†ç”Ÿã™ã‚‹é–¢æ•°
    function speakText2(text) {
      
      const utterance = new SpeechSynthesisUtterance(text);
      utterance.lang = 'zh-CN'; // ä¸­å›½èªã®è¨€èªã‚³ãƒ¼ãƒ‰
      // ios ä¸­å›½èªéŸ³å£°ä¸å…·åˆã®è¨‚æ­£
      // åˆ©ç”¨å¯èƒ½ãªéŸ³å£°ã‚’ç¢ºèª
      const voices = speechSynthesis.getVoices();
      const chineseVoice = getChineseVoice();

      if (chineseVoice) {
        utterance.voice = chineseVoice;
      } else {
        console.warn('Chinese voice not found, using default voice.');
      }
      // ios ä¸­å›½èªéŸ³å£°ä¸å…·åˆã®è¨‚æ­£
      synth.speak(utterance);
    }
    // ãƒ†ã‚­ã‚¹ãƒˆã‚’éŸ³å£°ã«å¤‰æ›ã—ã¦å†ç”Ÿã™ã‚‹é–¢æ•°
    function speakText3(param1) {
      const td = param1;
       //2023/04/27 è¿½åŠ ã€€èƒŒæ™¯è‰²
       if (tdOLD === undefined){
          tdOLD = param1;
          tdOLDColor = tdOLD.style.backgroundColor;
        } else {
          tdOLD.style.backgroundColor = tdOLDColor;
          tdOLD = param1;
        }
        //2023/04/27 è¿½åŠ ã€€èƒŒæ™¯è‰²
        td.style.backgroundColor = 'cyan';

      const utterance = new SpeechSynthesisUtterance(td.textContent);
      utterance.lang = 'zh-CN'; // ä¸­å›½èªã®è¨€èªã‚³ãƒ¼ãƒ‰
      // ios ä¸­å›½èªéŸ³å£°ä¸å…·åˆã®è¨‚æ­£
      // åˆ©ç”¨å¯èƒ½ãªéŸ³å£°ã‚’ç¢ºèª
      const voices = speechSynthesis.getVoices();
      const chineseVoice = getChineseVoice();

      if (chineseVoice) {
        utterance.voice = chineseVoice;
      } else {
        console.warn('Chinese voice not found, using default voice.');
      }
      // ios ä¸­å›½èªéŸ³å£°ä¸å…·åˆã®è¨‚æ­£
      synth.speak(utterance);
    }
    // ios ä¸­å›½èªéŸ³å£°ä¸å…·åˆã®è¨‚æ­£ 2024-12-09
    function getChineseVoice() {
      if (voices.length === 0) {
        voices = speechSynthesis.getVoices();
      }
      return voices.find(voice => voice.lang === 'zh-CN');
    }

    // éŸ³å£°ãƒªã‚¹ãƒˆãŒæ›´æ–°ã•ã‚ŒãŸã¨ãã«å†å–å¾—
    speechSynthesis.onvoiceschanged = function () {
      voices = speechSynthesis.getVoices();
    };
    // ios ä¸­å›½èªéŸ³å£°ä¸å…·åˆã®è¨‚æ­£ 2024-12-09
    // æ­£è§£ä¸æ­£è§£ã®åˆ¤æ–­
    function checkAnswer(isCorrect) {
      // ã“ã“ã«æ­£è§£ä¸æ­£è§£ã®å‡¦ç†ã‚’è¿½åŠ ã™ã‚‹
      if (isCorrect) {
        correctCount++;
      } else {
        incorrectCount++;
      }

      // çµæœã‚’è¡¨ç¤ºã™ã‚‹
      displayResult();
    }

    // çµæœã‚’è¡¨ç¤ºã™ã‚‹é–¢æ•°
    function displayResult() {
      resultDiv.textContent = `æ­£è§£: ${correctCount} å› ä¸æ­£è§£: ${incorrectCount} å›`;
    }



    // æœ€åˆã®ã‚«ãƒ¼ãƒ‰ã‚’è¡¨ç¤º
    flashcard.textContent = 'ğŸ‘‰æŒ‰ã€Œä¸‹ä¸€ä¸ªã€ï¼ˆæ¬¡ã¸ï¼‰ğŸ¼çœ‹å•è¯å¡';
    // ãƒ•ãƒ©ãƒƒã‚·ãƒ¥ã‚«ãƒ¼ãƒ‰ãŒã‚¯ãƒªãƒƒã‚¯ã•ã‚ŒãŸæ™‚ã®å‡¦ç†
    flashcard.addEventListener('click', () => {
      if (termSave === 'ch') {
        speakText(flashcard.textContent);
      }
    });
    //
    const btnKensaku = document.getElementById('btnKensaku');
    btnKensaku.addEventListener('click', (e) => {
      e.preventDefault();
      if (resultKensaku.contains(resultKensakuContent)) {
        resultKensakuContent.remove();

      }
      divTangoCard.classList.add('divTangoCardNoDisplay');
      divTangoCard.classList.remove('divTangoCardDisplay');
      resultKensakuContent = document.createElement('div');
      resultKensakuContent.setAttribute('id', 'resultKensakuContent');
      resultKensaku.appendChild(resultKensakuContent);
      resultKensaku.classList.remove('resultKensakuNoDisplay');
      resultKensaku.classList.add('resultKensakuDisplay');
      var input, filter, i, txtValue, div, table, tbody, tr, td;
      input = document.getElementById('myInput');
      filter = input.value;


      table = document.createElement('table');
      table.setAttribute('border', '1');
      resultKensakuContent.appendChild(table);
      tbody = document.createElement('tbody');
      table.appendChild(tbody);
      let isFind = false;
      for (i = 1; i < flashcardDatas.length; i++) {
        for (let j = 0; j < flashcardDatas[i].length; j++) {
          let sheetName = flashcardDatas[0][i - 1];
          if (sheetName.indexOf(filter) > -1 || flashcardDatas[i][j][1].indexOf(filter) > -1 || flashcardDatas[i][j][2].indexOf(filter) > -1  || filter === 'all') {
            console.log(flashcardDatas[i][j]);
            isFind = true;

            //

            tr = document.createElement('tr');
            td = document.createElement('td');
            // td.textContent = flashcardDatas[0][i - 1];
            td.textContent = sheetName;
            tr.appendChild(td);


            td = document.createElement('td');
            td.textContent = flashcardDatas[i][j][1];
            tr.appendChild(td);

            td = document.createElement('td');
            td.textContent = flashcardDatas[i][j][2];
            td.setAttribute('onclick', 'speakText3(this)');
            td.setAttribute('class', 'clkBtn');


            tr.appendChild(td);
            td = document.createElement('td');
            td.textContent = flashcardDatas[i][j][3];
            tr.appendChild(td);
            //  internet
            if (flashcardDatas[i][j][5] !== '') {
              td = document.createElement('td');
              let atag = document.createElement('a');
  
              let gazouURL0 = flashcardDatas[i][j][5];
              atag.setAttribute('href', gazouURL0);
              atag.setAttribute('class', 'classGazou');
              atag.setAttribute('target', '_blank');
              atag.textContent = 'å‚è€ƒã‚µã‚¤ãƒˆ'
              td.appendChild(atag);
              tr.appendChild(td);
            }
            //  ç”»åƒ
            if (flashcardDatas[i][j][4] !== '') {
              td = document.createElement('td');
              let atag = document.createElement('a');
  
              let gazouURL0 = flashcardDatas[i][j][4];
              atag.setAttribute('href', gazouURL0);
              atag.setAttribute('class', 'classGazou');
              atag.setAttribute('target', '_blank');
             
              td.appendChild(atag);
              tr.appendChild(td);
              let img = document.createElement('img');
  
  
              img.setAttribute('src', gazouURL0);
              img.setAttribute('class', 'classGazou classImageSize');
              atag.appendChild(img);
              td.appendChild(atag);
              tr.appendChild(td);
            }

            


          } else {
            isFind = false;
          }
          if (isFind) {

            tbody.appendChild(tr);
          }

        }
      }
      resultKensakuClear = document.createElement('div');
      resultKensakuClear.setAttribute('id', 'resultKensakuClear');
      resultKensakuClear.textContent = 'æˆ»ã‚‹';
      resultKensakuClear.setAttribute('onclick', 'fncresultKensakuClear()');
      resultKensakuContent.appendChild(resultKensakuClear);
    });
    //
    function fncresultKensakuClear() {
      divTangoCard.classList.remove('divTangoCardNoDisplay');
      divTangoCard.classList.add('divTangoCardDisplay');
      resultKensakuContent.remove();
      myInput.value = '';
      resultKensaku.classList.add('resultKensakuNoDisplay');
      resultKensaku.classList.remove('resultKensakuDisplay');
    }


  </script>
</body>

</html>